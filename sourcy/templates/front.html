{% import util %}
{% extends "base.html" %}
{% block title %}Sourcy{% end %}


{% block main %}

<div style="text-align:center;">
<div style="display: inline-block; text-align: left;">

<img src="/static/howitworks.png" alt="How sourcy works" style="display: block; margin-left: auto; margin-right: auto"/>

<div id="random-arts">
<h2>Some articles which need sourcing</h2>
<ul>
{% for art in random_arts %}
<li>{% module art_item(art,show_pubdate=True) %}</li>
{% end %}
</ul>
(<a href="/">show me some others</a>)
</div>



</div>
</div>

<br/>
<br/>

<div id="recent-activity" style="float:left; width: 50%;">
<h2>Recent activity</h2>
{% for art, art_actions in groupby(recent_actions, key = lambda x: x.article) %}
<span>on {% module art_item(art, show_icons=False, show_pubdate=True) %}:</span>
<ul class="action-list">
    {% for user, user_actions in groupby(art_actions, key = lambda x: x.user) %}
    <li class="user-actions">
        <span class="user">{% module user(user, show_avi=True) %}:</span>
        <ul>
        {% for act in user_actions %}
        <li class="action"> {% module action(act) %}
        <span class="when">{{ locale.format_date(act.performed, shorter=True) }}</span></li>
        {% end %}
        </ul>
    </li>
    {% end %}
</ul>
{% end %}
</div>

<div id="daily" style="float:right; width: 40%;">
<h2>Progress</h2>
<p>Percentage of articles sourced per day, over the last week</p>
<ul class="daily">
{% for day, row in daily %}
{% module daily(day,row) %}
{% end %}
</ul>
</div>


{% end %}

