{% extends "base.html" %}
{% block title %}Article {{art.id}}{% end %}

{% block extra_js %}

function switch_tabs(obj)
{
	var id = obj.attr("href");

	$('#readable, #original').hide();
	$(id).show();

	$('#view nav a').removeClass("selected");
	obj.addClass("selected");
}

$('#view nav a').click(function(){
		switch_tabs($(this));
});
 
switch_tabs($('#view nav a[href="#readable"]'));

$('#original iframe').css({'min-height': $('#readable').height()-10});



{% end %}

{% block main %}
<h2>{{art.id}}: {{art.headline}}</h2>
<a href="{{art.permalink}}"><code>{{art.permalink}}</code></a>
<div>
<div id="view">
    <nav>
    <ul>
		<li><a href="#readable">Readable</a></li>
		<li><a href="#original">Original ({% module domain(art.permalink) %})</a></li>
	</ul>
    </nav>

    <div id="readable">
    {% raw article_content %}
    </div>
    <div id="original">
      <iframe src="{{art.permalink}}"></iframe>
    </div>
</div>
<div id="tools">


  <div>
  <h3>known sources</h3>
  {% if sources %}
  <ul>
  {% for s in sources %}
  <li><a href="{{s.url}}">{{s.url}}</a></li>
  {% end %}
  </ul>
  {% else %}
  <p>None<p>
  </div>
  {% end %}

  <div>
    <p>Add a source:</p>
    <form action="/edit" method="post">
        <label for="url">URL or DOI of paper</label><br/>
        <input type="hidden" name="art_id" value="{{art.id}}"/>
        <input type="text" name="url" id="url" columns="80"/><br/>
        <input type="submit" value="submit"/><br/>
        <span class="helptext"><a href="#">what's a DOI?</a> <a href="#">guidelines on linking to academic papers</a></span><br/>
    </form>
  </div>


  {% if institutions %}
  <hr/>
  <h3 class="hilite institution">Institutions:</h3>
  <ul>
  {% for r in institutions %}
  <li><a class="institution" href="{{r[1]}}">{{r[0]}}</a></li>
  {% end %}
  </ul>
  {% end %}

  {% if journals %}
  <hr/>
  <h3 class="hilite journal">Journals:</h3>
  <ul>
  {% for r in journals %}
  <li><a class="journal" href="{{r[1]}}">{{r[0]}}</a></li>
  {% end %}
  </ul>
  {% end %}
  <p>(add a missing <a href="/addjournal">journal</a> or <a href="/addinstitution">institution</a>)</p>

  <hr/>
  <h3>Search for papers...</h3>
  <form action="http://scholar.google.co.uk/scholar" method="GET">
      {% if researchers %}
      written by:<br/>
      {% for idx,r in enumerate(researchers) %}
      <input type="checkbox" name="as_sauthors" value="{{r['search_value']}}" id="r_{{idx}}"/><label for="r_{{idx}}">{{r['name']}}</label><br/>
      {% end %}
      {% else %}
      <label for="r">written by:</label><br/>
      <input type="text" name="as_sauthors" id="r"/><br/>
      {% end %}

      {% if journals %}
      published in:<br/>
      {% for idx,j in enumerate(journals) %}
      <input type="checkbox" name="as_publication" value="{{j[0]}}" id="j_{{idx}}"/><label for="j_{{idx}}">{{j[0]}} (<a href="{{j[1]}}">web site</a>)</label><br/>
      {% end %}
      {% else %}
      <label for="j">published in:</label>
      <input type="text" name="as_publication" id="j"/><br/>
      {% end %}

      containing keywords
      <input type="text" name="as_q" /><br/>
      <input type="submit" value="Search" name="btnG" />
  </form>

</div>
</div>
{% end %}

