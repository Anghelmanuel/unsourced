<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="style.css" />
    <link href="css/smoothness/jquery-ui-1.8.16.custom.css" rel="stylesheet" />	
<!--    <script type="text/javascript" src="js/jquery-1.6.2.min.js"></script> -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    <script src="js/jquery-ui-1.8.16.custom.min.js"></script>
    <script src="js/jquery.highlight.js"></script>
    <script src="js/indicators.js"></script>
    <script src="testarticle.js"></script>
    <script src="helpers.js"></script>

        <script>
            $(document).ready( function() {

                article_html = data['html'];

                function find_indicators(html) {
                    // strip tags and normalise whitespace
                    html = html.replace(/<[^>]*>?/g, '');
                    html = html.replace(/\s+/g, ' ');


                    hits = []
                        kind = "study";
                        pats = indicators[kind];
                        for( var i=0; i<pats.length; ++i) {

                            var pat = pats[i].pat
                            var m = html.match(pat);
                            if(m) {
                                hits.push(m[0]);
                            }
                        }

                    var out = '';
                    for(var i=0; i<hits.length; ++i) {
                        $('#view-readable').highlight(hits[i],{className: 'indicative'});
                    }

                    $('#view-readable').highlight('North Carolina State University', {className:'institution'});
                    $('#view-readable').highlight('FASEB Journal', {className:'journal'});
                    $('#view-readable').highlight('Dr Gerald Weissmann', {className:'person'});
                    $('#view-readable').highlight('Dr Slavo Komarnytsky',{className:'person'});
                }
//                find_indicators(article_html);
//                $('ul#indicators li q').each(function() { $('body').highlight($(this).text());});
/*                $('ul#indicators li q').live( 'click', function() {
                        $('#view-readable').removeHighlight();
                        $('#view-readable').highlight($(this).text());
                    });
                    */


//                console.log(data);
                $('#view').tabs();
//                $('#view-readable').innerHtml = data['html'];
                $('#view-readable').html(article_html);
                var url = "http://www.dailymail.co.uk/news/article-2046255/Mustard-spinach-make-fitness-fanatics-look-like-Popeye.html";
                //var url = "Mustard-spinach-make-fitness-fanatics-look-like-Popeye.html";
                $('#targ').attr('src',url);
                $('#targ').ready(function()
                {
                    find_indicators(article_html);
//                    $('#view-readable').html( data['html']);
                    
                });
            });
    </script>
</head>
<body>
    <div id="content">
        <div id="header">
            <h1>Article Sourcing Thing</h1>
        </div>
        <div id="view">
            <ul>
				<li><a href="#view-readable">Readable</a></li>
				<li><a href="#view-original">Original (mailonline.co.uk)</a></li>
            </ul>
            <div id="view-readable">blahblah</div>
            <div id="view-original"><iframe id="targ" ></iframe></div>
        </div>
        <div id="editor">

            <ul id="indicators">
            </ul>
            <h2>Possibly useful links</h2>
            <ul>
                <li><a href="http://www.ncsu.edu/">North Carolina State University</a></li>
                <li><a href="http://www.fasebj.org/">FASEB Journal</a></li>
                <li>Google scholar - papers crediting:
                    <ul>
                        <li><a href="http://scholar.google.co.uk/scholar?as_q=&num=10&btnG=Search+Scholar&as_epq=&as_oq=&as_eq=&as_occt=any&as_sauthors=%22S+Komarnytsky%22&as_publication=FASEB+Journal&as_ylo=&as_yhi=&as_sdt=1.&as_sdtp=on&as_sdtf=&as_sdts=5&hl=en">S Komarnytsky</a></li>
                        <li><a href="http://scholar.google.co.uk/scholar?hl=en&q=author%3A%22G+Weissmann%22&as_publication=FASEB+Journal&btnG=Search&as_sdt=0%2C5&as_ylo=&as_vis=0">G Weissmann</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</body>
</html>
